{"version":3,"sources":["../src/core/event-emitter.ts","../src/core/utils/reconnect.ts","../src/core/utils/logger.ts","../src/core/websocket-manager.ts","../src/core/utils/audio-format.ts","../src/core/audio-capture-manager.ts","../src/core/audio-playback-manager.ts","../src/core/echo-prevention.ts","../src/core/voice-stream-config.ts","../src/core/voice-stream-sdk.ts","../src/widget/hooks/use-voice-chat.ts","../src/widget/theme.ts","../src/widget/components/FloatingButton.tsx","../src/widget/components/StatusIndicator.tsx","../src/widget/components/ChatHeader.tsx","../src/widget/components/MessageBubble.tsx","../src/widget/components/MessageList.tsx","../src/widget/components/MicButton.tsx","../src/widget/components/InputBar.tsx","../src/widget/components/PoweredByFooter.tsx","../src/widget/components/ChatPanel.tsx","../src/widget/components/VoiceChatWidget.tsx"],"names":["Platform","PermissionsAndroid","useState","useRef","useEffect","useCallback","jsx","TouchableOpacity","jsxs","View","StyleSheet","styles","Text","Animated","FlatList","TextInput","Dimensions","KeyboardAvoidingView","TouchableWithoutFeedback"],"mappings":"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","file":"index.cjs","sourcesContent":["/**\n * Lightweight typed event emitter for internal use.\n * Avoids external dependencies while providing full type safety.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport class TypedEventEmitter<EventMap extends Record<string, any> = Record<string, any>> {\n  private listeners = new Map<keyof EventMap, Set<Function>>();\n\n  on<K extends keyof EventMap>(\n    event: K,\n    callback: EventMap[K] extends void ? () => void : (data: EventMap[K]) => void,\n  ): () => void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(callback);\n\n    // Return unsubscribe function\n    return () => {\n      this.listeners.get(event)?.delete(callback);\n    };\n  }\n\n  off<K extends keyof EventMap>(\n    event: K,\n    callback: Function,\n  ): void {\n    this.listeners.get(event)?.delete(callback);\n  }\n\n  protected emit<K extends keyof EventMap>(\n    ...[event, data]: EventMap[K] extends void ? [K] : [K, EventMap[K]]\n  ): void {\n    const set = this.listeners.get(event);\n    if (!set) return;\n    for (const cb of set) {\n      try {\n        cb(data);\n      } catch {\n        // Swallow listener errors to prevent cascade\n      }\n    }\n  }\n\n  removeAllListeners(): void {\n    this.listeners.clear();\n  }\n}\n","const JITTER_FACTOR = 0.3;\n\n/**\n * Calculate exponential backoff delay with jitter.\n * Matches the iOS SDK's reconnection strategy.\n *\n * @param attempt - Current attempt number (0-indexed)\n * @param baseDelay - Initial delay in ms\n * @param maxDelay - Maximum delay cap in ms\n * @returns Delay in ms\n */\nexport function calculateBackoff(\n  attempt: number,\n  baseDelay: number,\n  maxDelay: number,\n): number {\n  const exponential = Math.min(maxDelay, baseDelay * Math.pow(2, attempt));\n  const jitter = exponential * JITTER_FACTOR * Math.random();\n  return Math.floor(exponential + jitter);\n}\n","const TAG = '[VoiceStreamSDK]';\n\nlet debugEnabled = false;\n\nexport function setDebugLogging(enabled: boolean): void {\n  debugEnabled = enabled;\n}\n\nexport function logDebug(...args: unknown[]): void {\n  if (debugEnabled) {\n    console.log(TAG, ...args);\n  }\n}\n\nexport function logWarn(...args: unknown[]): void {\n  console.warn(TAG, ...args);\n}\n\nexport function logError(...args: unknown[]): void {\n  console.error(TAG, ...args);\n}\n","import { TypedEventEmitter } from './event-emitter';\nimport type { WSManagerEventMap, ResolvedConfig, ConnectionState } from './types';\nimport { calculateBackoff } from './utils/reconnect';\nimport { logDebug, logWarn, logError } from './utils/logger';\n\n/**\n * Manages WebSocket connection with automatic reconnection,\n * keep-alive pings, and message routing.\n *\n * Mirrors iOS WebSocketManager.swift\n */\nexport class WebSocketManager extends TypedEventEmitter<WSManagerEventMap> {\n  private ws: WebSocket | null = null;\n  private config: ResolvedConfig;\n  private state: ConnectionState = 'disconnected';\n  private reconnectAttempts = 0;\n  private reconnectTimer: ReturnType<typeof setTimeout> | null = null;\n  private pingTimer: ReturnType<typeof setTimeout> | null = null;\n  private manualDisconnect = false;\n\n  constructor(config: ResolvedConfig) {\n    super();\n    this.config = config;\n  }\n\n  getConnectionState(): ConnectionState {\n    return this.state;\n  }\n\n  isConnected(): boolean {\n    return this.state === 'connected';\n  }\n\n  connect(): void {\n    if (this.state === 'connected' || this.state === 'connecting') return;\n\n    this.manualDisconnect = false;\n    this.reconnectAttempts = 0;\n    this.setState('connecting');\n    this.openConnection();\n  }\n\n  disconnect(): void {\n    this.manualDisconnect = true;\n    this.clearTimers();\n\n    if (this.ws) {\n      this.ws.onopen = null;\n      this.ws.onclose = null;\n      this.ws.onerror = null;\n      this.ws.onmessage = null;\n      this.ws.close(1000, 'Client disconnect');\n      this.ws = null;\n    }\n\n    this.setState('disconnected');\n    this.emit('close', { code: 1000, reason: 'Client disconnect' });\n  }\n\n  sendText(text: string): void {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logWarn('Cannot send text: WebSocket not open');\n      return;\n    }\n    this.ws.send(text);\n  }\n\n  sendBinary(data: ArrayBuffer): void {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      return;\n    }\n    this.ws.send(data);\n  }\n\n  sendJSON(payload: Record<string, unknown>): void {\n    this.sendText(JSON.stringify(payload));\n  }\n\n  cleanup(): void {\n    this.disconnect();\n    this.removeAllListeners();\n  }\n\n  //  Private \n\n  private openConnection(): void {\n    try {\n      const url = this.buildUrl();\n      logDebug('Connecting to', url);\n\n      this.ws = new WebSocket(url);\n      // React Native WebSocket supports binaryType\n      (this.ws as any).binaryType = 'arraybuffer';\n\n      this.ws.onopen = () => this.handleOpen();\n      this.ws.onclose = (event) => this.handleClose(event);\n      this.ws.onerror = () => this.handleError();\n      this.ws.onmessage = (event) => this.handleMessage(event);\n    } catch (err) {\n      logError('Connection failed:', err);\n      this.emit('error', String(err));\n      this.scheduleReconnect();\n    }\n  }\n\n  private buildUrl(): string {\n    const base = this.config.serverUrl;\n    const params = new URLSearchParams();\n    params.set('tenantId', this.config.tenantId);\n    if (this.config.authToken) {\n      params.set('token', this.config.authToken);\n    }\n    params.set('channel', 'react-native');\n\n    const separator = base.includes('?') ? '&' : '?';\n    return `${base}${separator}${params.toString()}`;\n  }\n\n  private handleOpen(): void {\n    logDebug('WebSocket connected');\n    this.reconnectAttempts = 0;\n    this.setState('connected');\n\n    // Send tenant info immediately (matches iOS SDK behavior)\n    this.sendJSON({\n      type: 'tenant_info',\n      tenant_id: this.config.tenantId,\n      tenant_name: this.config.tenantName,\n      ...(this.config.authToken && { auth_token: this.config.authToken }),\n      ...(this.config.aiClinicMode && { ai_clinic_mode: true }),\n      ...(this.config.fillerPhraseEn && { filler_phrase_en: this.config.fillerPhraseEn }),\n      ...(this.config.fillerPhraseAr && { filler_phrase_ar: this.config.fillerPhraseAr }),\n    });\n\n    this.startPingTimer();\n    this.emit('open');\n  }\n\n  private handleClose(event: WebSocketCloseEvent): void {\n    logDebug('WebSocket closed:', event.code, event.reason);\n    this.clearTimers();\n    this.ws = null;\n\n    if (this.manualDisconnect) {\n      this.setState('disconnected');\n      this.emit('close', { code: event.code, reason: event.reason ?? '' });\n      return;\n    }\n\n    this.emit('close', { code: event.code, reason: event.reason ?? '' });\n    this.scheduleReconnect();\n  }\n\n  private handleError(): void {\n    logError('WebSocket error');\n    this.emit('error', 'WebSocket connection error');\n  }\n\n  private handleMessage(event: WebSocketMessageEvent): void {\n    // Binary audio frame\n    if (event.data instanceof ArrayBuffer) {\n      this.emit('binaryMessage', event.data);\n      return;\n    }\n\n    // Text message (JSON)\n    if (typeof event.data === 'string') {\n      logDebug('Received text:', event.data.substring(0, 100));\n      this.emit('textMessage', event.data);\n      return;\n    }\n\n    logWarn('Unknown message type received');\n  }\n\n  private startPingTimer(): void {\n    this.clearPingTimer();\n    this.pingTimer = setInterval(() => {\n      if (this.isConnected()) {\n        this.sendJSON({ type: 'ping', ts: Date.now() });\n      }\n    }, this.config.pingIntervalMs);\n  }\n\n  private scheduleReconnect(): void {\n    if (this.manualDisconnect || !this.config.autoReconnect) {\n      this.setState('disconnected');\n      return;\n    }\n\n    // Check max attempts (0 = unlimited)\n    if (\n      this.config.maxReconnectAttempts > 0 &&\n      this.reconnectAttempts >= this.config.maxReconnectAttempts\n    ) {\n      logError('Max reconnection attempts reached');\n      this.setState('disconnected');\n      this.emit('error', 'Max reconnection attempts reached');\n      return;\n    }\n\n    this.setState('reconnecting');\n    const delay = calculateBackoff(\n      this.reconnectAttempts,\n      this.config.reconnectDelayMs,\n      this.config.maxReconnectDelayMs,\n    );\n\n    logDebug(`Reconnecting in ${delay}ms (attempt ${this.reconnectAttempts + 1})`);\n\n    this.reconnectTimer = setTimeout(() => {\n      this.reconnectAttempts++;\n      this.openConnection();\n    }, delay);\n  }\n\n  private setState(newState: ConnectionState): void {\n    if (this.state === newState) return;\n    this.state = newState;\n    this.emit('connectionStateChanged', newState);\n  }\n\n  private clearTimers(): void {\n    this.clearPingTimer();\n    if (this.reconnectTimer) {\n      clearTimeout(this.reconnectTimer);\n      this.reconnectTimer = null;\n    }\n  }\n\n  private clearPingTimer(): void {\n    if (this.pingTimer) {\n      clearInterval(this.pingTimer);\n      this.pingTimer = null;\n    }\n  }\n}\n\n// React Native WebSocket event types\ninterface WebSocketCloseEvent {\n  code: number;\n  reason?: string;\n}\n\ninterface WebSocketMessageEvent {\n  data: string | ArrayBuffer;\n}\n","/**\n * Decode PCM16 little-endian bytes into Float32 samples (-1.0 to 1.0).\n */\nexport function decodePCM16LEToFloat32(pcmBytes: ArrayBuffer): Float32Array {\n  const view = new DataView(pcmBytes);\n  const numSamples = pcmBytes.byteLength / 2;\n  const float32 = new Float32Array(numSamples);\n\n  for (let i = 0; i < numSamples; i++) {\n    const int16 = view.getInt16(i * 2, true); // little-endian\n    float32[i] = int16 / 32768;\n  }\n\n  return float32;\n}\n\n/**\n * Encode Float32 samples into PCM16 little-endian bytes.\n */\nexport function encodeFloat32ToPCM16LE(float32: Float32Array): ArrayBuffer {\n  const buffer = new ArrayBuffer(float32.length * 2);\n  const view = new DataView(buffer);\n\n  for (let i = 0; i < float32.length; i++) {\n    const clamped = Math.max(-1, Math.min(1, float32[i]));\n    const int16 = clamped < 0 ? clamped * 32768 : clamped * 32767;\n    view.setInt16(i * 2, int16, true); // little-endian\n  }\n\n  return buffer;\n}\n\n/**\n * Amplify PCM16 audio data by a given factor with clamping.\n * Matches iOS SDK's 3x volume amplification.\n */\nexport function amplifyPCM16(pcmData: ArrayBuffer, factor: number): ArrayBuffer {\n  const view = new DataView(pcmData);\n  const result = new ArrayBuffer(pcmData.byteLength);\n  const resultView = new DataView(result);\n  const numSamples = pcmData.byteLength / 2;\n\n  for (let i = 0; i < numSamples; i++) {\n    const sample = view.getInt16(i * 2, true);\n    const amplified = Math.max(-32768, Math.min(32767, Math.round(sample * factor)));\n    resultView.setInt16(i * 2, amplified, true);\n  }\n\n  return result;\n}\n\n/**\n * Convert a base64 string to an ArrayBuffer.\n */\nexport function base64ToArrayBuffer(base64: string): ArrayBuffer {\n  const binaryString = atob(base64);\n  const bytes = new Uint8Array(binaryString.length);\n  for (let i = 0; i < binaryString.length; i++) {\n    bytes[i] = binaryString.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\n/**\n * Convert an ArrayBuffer to a base64 string.\n */\nexport function arrayBufferToBase64(buffer: ArrayBuffer): string {\n  const bytes = new Uint8Array(buffer);\n  let binary = '';\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return btoa(binary);\n}\n","import { Platform, PermissionsAndroid } from 'react-native';\nimport { TypedEventEmitter } from './event-emitter';\nimport type { AudioCaptureEventMap, ResolvedConfig, VoiceStreamError } from './types';\nimport { base64ToArrayBuffer } from './utils/audio-format';\nimport { logDebug, logError } from './utils/logger';\n\n// Lazy import to avoid crashes when not installed\nlet LiveAudioStream: any = null;\n\nfunction getLiveAudioStream(): any {\n  if (!LiveAudioStream) {\n    try {\n      LiveAudioStream = require('react-native-live-audio-stream').default;\n    } catch {\n      throw new Error(\n        'react-native-live-audio-stream is required for audio capture. ' +\n        'Install it with: npm install react-native-live-audio-stream'\n      );\n    }\n  }\n  return LiveAudioStream;\n}\n\n/**\n * Manages microphone audio capture, providing raw PCM16 data.\n * Mirrors iOS AudioCaptureManager.swift\n */\nexport class AudioCaptureManager extends TypedEventEmitter<AudioCaptureEventMap> {\n  private config: ResolvedConfig;\n  private isCapturing = false;\n  private isMuted = false;\n  private dataSubscription: (() => void) | null = null;\n\n  constructor(config: ResolvedConfig) {\n    super();\n    this.config = config;\n  }\n\n  get capturing(): boolean {\n    return this.isCapturing;\n  }\n\n  get muted(): boolean {\n    return this.isMuted;\n  }\n\n  /**\n   * Request microphone permission.\n   * Uses React Native's built-in PermissionsAndroid on Android.\n   * On iOS, the native mic API triggers the permission prompt automatically.\n   */\n  async requestPermission(): Promise<boolean> {\n    if (Platform.OS === 'android') {\n      try {\n        const granted = await PermissionsAndroid.request(\n          PermissionsAndroid.PERMISSIONS.RECORD_AUDIO,\n          {\n            title: 'Microphone Permission',\n            message: 'This app needs access to your microphone for voice chat.',\n            buttonPositive: 'Allow',\n            buttonNegative: 'Deny',\n          },\n        );\n        return granted === PermissionsAndroid.RESULTS.GRANTED;\n      } catch (err) {\n        logError('Permission request failed:', err);\n        return false;\n      }\n    }\n\n    // iOS: permission is requested automatically by the native audio module\n    return true;\n  }\n\n  /**\n   * Start capturing audio from the microphone.\n   * Emits 'data' events with ArrayBuffer of PCM16 audio.\n   */\n  async startCapture(): Promise<void> {\n    if (this.isCapturing) return;\n\n    const hasPermission = await this.requestPermission();\n    if (!hasPermission) {\n      const error: VoiceStreamError = {\n        code: 'AUDIO_PERMISSION_DENIED',\n        message: 'Microphone permission denied',\n      };\n      this.emit('error', error);\n      return;\n    }\n\n    try {\n      const stream = getLiveAudioStream();\n\n      stream.init({\n        sampleRate: this.config.audioInputSampleRate,\n        channels: this.config.audioChannels,\n        bitsPerSample: this.config.audioBitDepth,\n        audioSource: 6, // VOICE_COMMUNICATION on Android\n        bufferSize: this.config.audioBufferSize,\n      });\n\n      // Listen for audio data (base64-encoded PCM)\n      stream.on('data', (base64Data: string) => {\n        if (this.isMuted) return; // Discard frames when muted (echo prevention)\n\n        try {\n          const audioBuffer = base64ToArrayBuffer(base64Data);\n          this.emit('data', audioBuffer);\n        } catch (err) {\n          logError('Audio data decode error:', err);\n        }\n      });\n\n      stream.start();\n      this.isCapturing = true;\n      this.isMuted = false;\n      logDebug('Audio capture started');\n    } catch (err) {\n      logError('Audio capture start failed:', err);\n      const error: VoiceStreamError = {\n        code: 'AUDIO_CAPTURE_FAILED',\n        message: `Failed to start audio capture: ${err}`,\n      };\n      this.emit('error', error);\n    }\n  }\n\n  /**\n   * Stop capturing audio.\n   */\n  stopCapture(): void {\n    if (!this.isCapturing) return;\n\n    try {\n      const stream = getLiveAudioStream();\n      stream.stop();\n    } catch {\n      // Ignore errors on stop\n    }\n\n    this.isCapturing = false;\n    this.isMuted = false;\n    logDebug('Audio capture stopped');\n  }\n\n  /**\n   * Mute the microphone (discard frames without stopping capture).\n   * Used by echo prevention to avoid latency of stop/start.\n   */\n  mute(): void {\n    this.isMuted = true;\n    logDebug('Mic muted');\n  }\n\n  /**\n   * Unmute the microphone (resume emitting frames).\n   */\n  unmute(): void {\n    this.isMuted = false;\n    logDebug('Mic unmuted');\n  }\n\n  cleanup(): void {\n    this.stopCapture();\n    this.removeAllListeners();\n  }\n}\n","import { TypedEventEmitter } from './event-emitter';\nimport type { AudioPlaybackEventMap, ResolvedConfig, VoiceStreamError } from './types';\nimport { amplifyPCM16, decodePCM16LEToFloat32 } from './utils/audio-format';\nimport { logDebug, logError } from './utils/logger';\n\n/**\n * Manages audio playback of PCM16 data received from the server.\n * Uses react-native-audio-api (AudioContext) for low-latency playback.\n *\n * Mirrors iOS AudioPlaybackManager.swift\n */\nexport class AudioPlaybackManager extends TypedEventEmitter<AudioPlaybackEventMap> {\n  private config: ResolvedConfig;\n  private audioContext: any = null; // AudioContext from react-native-audio-api\n  private bufferQueue: ArrayBuffer[] = [];\n  private isPlaying = false;\n  private scheduledEndTime = 0;\n  private pendingBuffers = 0;\n  private drainCheckTimer: ReturnType<typeof setTimeout> | null = null;\n\n  /** Volume amplification factor (matches iOS 3x) */\n  private readonly VOLUME_FACTOR = 3.0;\n\n  constructor(config: ResolvedConfig) {\n    super();\n    this.config = config;\n  }\n\n  get playing(): boolean {\n    return this.isPlaying;\n  }\n\n  get queueLength(): number {\n    return this.bufferQueue.length + this.pendingBuffers;\n  }\n\n  /**\n   * Initialize the audio context for playback.\n   */\n  private ensureAudioContext(): void {\n    if (this.audioContext) return;\n\n    try {\n      const AudioAPI = require('react-native-audio-api');\n      this.audioContext = new AudioAPI.AudioContext({\n        sampleRate: this.config.audioOutputSampleRate,\n      });\n      logDebug('AudioContext created at', this.config.audioOutputSampleRate, 'Hz');\n    } catch (err) {\n      logError('Failed to create AudioContext:', err);\n      throw new Error(\n        'react-native-audio-api is required for audio playback. ' +\n        'Install it with: npm install react-native-audio-api'\n      );\n    }\n  }\n\n  /**\n   * Enqueue PCM16 audio data for playback.\n   * Auto-starts playback if not already playing.\n   */\n  enqueueAudio(pcmData: ArrayBuffer): void {\n    // Amplify audio (3x volume, matching iOS)\n    const amplified = amplifyPCM16(pcmData, this.VOLUME_FACTOR);\n    this.bufferQueue.push(amplified);\n\n    if (!this.isPlaying) {\n      this.startPlayback();\n    } else {\n      this.processQueue();\n    }\n  }\n\n  /**\n   * Start playback and process the buffer queue.\n   */\n  private startPlayback(): void {\n    try {\n      this.ensureAudioContext();\n      this.isPlaying = true;\n      this.scheduledEndTime = this.audioContext.currentTime;\n      this.emit('started');\n      logDebug('Playback started');\n      this.processQueue();\n    } catch (err) {\n      logError('Playback start failed:', err);\n      const error: VoiceStreamError = {\n        code: 'AUDIO_PLAYBACK_FAILED',\n        message: `Failed to start playback: ${err}`,\n      };\n      this.emit('error', error);\n    }\n  }\n\n  /**\n   * Process queued audio buffers and schedule them for playback.\n   */\n  private processQueue(): void {\n    if (!this.audioContext || this.bufferQueue.length === 0) {\n      this.checkDrain();\n      return;\n    }\n\n    while (this.bufferQueue.length > 0) {\n      const pcmData = this.bufferQueue.shift()!;\n      this.scheduleBuffer(pcmData);\n    }\n  }\n\n  /**\n   * Convert PCM16 data to an AudioBuffer and schedule it.\n   */\n  private scheduleBuffer(pcmData: ArrayBuffer): void {\n    try {\n      const float32 = decodePCM16LEToFloat32(pcmData);\n      const numSamples = float32.length;\n      const sampleRate = this.config.audioOutputSampleRate;\n\n      const audioBuffer = this.audioContext.createBuffer(1, numSamples, sampleRate);\n      const channelData = audioBuffer.getChannelData(0);\n      for (let i = 0; i < numSamples; i++) {\n        channelData[i] = float32[i];\n      }\n\n      const source = this.audioContext.createBufferSource();\n      source.buffer = audioBuffer;\n      source.connect(this.audioContext.destination);\n\n      // Schedule at the end of current playback\n      const now = this.audioContext.currentTime;\n      const startTime = Math.max(now, this.scheduledEndTime);\n      source.start(startTime);\n\n      const duration = numSamples / sampleRate;\n      this.scheduledEndTime = startTime + duration;\n      this.pendingBuffers++;\n\n      // Track buffer completion\n      source.onended = () => {\n        this.pendingBuffers = Math.max(0, this.pendingBuffers - 1);\n        this.checkDrain();\n      };\n    } catch (err) {\n      logError('Buffer scheduling failed:', err);\n    }\n  }\n\n  /**\n   * Check if all buffers have been played (idle state).\n   */\n  private checkDrain(): void {\n    if (this.drainCheckTimer) {\n      clearTimeout(this.drainCheckTimer);\n    }\n\n    // Small delay to batch checks\n    this.drainCheckTimer = setTimeout(() => {\n      if (this.bufferQueue.length === 0 && this.pendingBuffers === 0 && this.isPlaying) {\n        this.isPlaying = false;\n        logDebug('Playback idle  all buffers drained');\n        this.emit('idle');\n      }\n    }, 50);\n  }\n\n  /**\n   * Clear all queued audio and stop playback.\n   */\n  clearQueue(): void {\n    this.bufferQueue = [];\n    this.pendingBuffers = 0;\n\n    if (this.audioContext) {\n      try {\n        // Close and recreate context to stop all scheduled audio\n        this.audioContext.close();\n        this.audioContext = null;\n      } catch {\n        // Ignore close errors\n      }\n    }\n\n    this.isPlaying = false;\n    logDebug('Audio queue cleared');\n    this.emit('idle');\n  }\n\n  cleanup(): void {\n    this.clearQueue();\n    if (this.drainCheckTimer) {\n      clearTimeout(this.drainCheckTimer);\n    }\n    this.removeAllListeners();\n  }\n}\n","import type { AudioCaptureManager } from './audio-capture-manager';\nimport type { AudioPlaybackManager } from './audio-playback-manager';\nimport { logDebug } from './utils/logger';\n\n/**\n * Echo prevention controller.\n * Mutes the microphone while audio is being played back,\n * then unmutes after all buffers are drained + a tail delay.\n *\n * This prevents the microphone from picking up the speaker's output,\n * which would cause echo/feedback in the conversation.\n *\n * Mirrors iOS SDK echo prevention logic.\n */\nexport class EchoPrevention {\n  /** Delay after playback ends before unmuting (matches iOS 0.5s) */\n  private static readonly TAIL_DELAY_MS = 500;\n\n  private captureManager: AudioCaptureManager;\n  private playbackManager: AudioPlaybackManager;\n  private unmutePendingTimer: ReturnType<typeof setTimeout> | null = null;\n  private unsubscribers: (() => void)[] = [];\n\n  constructor(capture: AudioCaptureManager, playback: AudioPlaybackManager) {\n    this.captureManager = capture;\n    this.playbackManager = playback;\n\n    // Mute mic when playback starts\n    this.unsubscribers.push(\n      playback.on('started', () => this.onPlaybackStarted()),\n    );\n\n    // Schedule unmute when playback goes idle\n    this.unsubscribers.push(\n      playback.on('idle', () => this.onPlaybackIdle()),\n    );\n  }\n\n  private onPlaybackStarted(): void {\n    // Cancel any pending unmute\n    if (this.unmutePendingTimer) {\n      clearTimeout(this.unmutePendingTimer);\n      this.unmutePendingTimer = null;\n    }\n\n    // Mute mic immediately\n    this.captureManager.mute();\n    logDebug('Echo prevention: mic muted (playback started)');\n  }\n\n  private onPlaybackIdle(): void {\n    // Cancel any existing timer\n    if (this.unmutePendingTimer) {\n      clearTimeout(this.unmutePendingTimer);\n    }\n\n    // Unmute after tail delay\n    this.unmutePendingTimer = setTimeout(() => {\n      this.captureManager.unmute();\n      this.unmutePendingTimer = null;\n      logDebug('Echo prevention: mic unmuted (playback idle + tail delay)');\n    }, EchoPrevention.TAIL_DELAY_MS);\n  }\n\n  /**\n   * Force unmute (e.g., when clearing audio queue).\n   */\n  forceUnmute(): void {\n    if (this.unmutePendingTimer) {\n      clearTimeout(this.unmutePendingTimer);\n      this.unmutePendingTimer = null;\n    }\n    this.captureManager.unmute();\n  }\n\n  destroy(): void {\n    if (this.unmutePendingTimer) {\n      clearTimeout(this.unmutePendingTimer);\n      this.unmutePendingTimer = null;\n    }\n    for (const unsub of this.unsubscribers) {\n      unsub();\n    }\n    this.unsubscribers = [];\n  }\n}\n","import type { VoiceStreamConfig, ResolvedConfig } from './types';\n\nconst DEFAULTS = {\n  autoReconnect: true,\n  maxReconnectAttempts: 5,\n  reconnectDelayMs: 1000,\n  maxReconnectDelayMs: 30000,\n  pingIntervalMs: 30000,\n  audioInputSampleRate: 16000,\n  audioOutputSampleRate: 24000,\n  audioChannels: 1,\n  audioBitDepth: 16,\n  audioBufferSize: 1600,\n  enableDebugLogging: false,\n  aiClinicMode: false,\n} as const;\n\n/**\n * Resolves a partial VoiceStreamConfig into a fully-populated ResolvedConfig\n * by applying default values for any unspecified fields.\n */\nexport function resolveConfig(config: VoiceStreamConfig): ResolvedConfig {\n  return {\n    serverUrl: config.serverUrl,\n    tenantId: config.tenantId,\n    tenantName: config.tenantName ?? config.tenantId,\n    authToken: config.authToken,\n    autoReconnect: config.autoReconnect ?? DEFAULTS.autoReconnect,\n    maxReconnectAttempts: config.maxReconnectAttempts ?? DEFAULTS.maxReconnectAttempts,\n    reconnectDelayMs: config.reconnectDelayMs ?? DEFAULTS.reconnectDelayMs,\n    maxReconnectDelayMs: config.maxReconnectDelayMs ?? DEFAULTS.maxReconnectDelayMs,\n    pingIntervalMs: config.pingIntervalMs ?? DEFAULTS.pingIntervalMs,\n    audioInputSampleRate: config.audioInputSampleRate ?? DEFAULTS.audioInputSampleRate,\n    audioOutputSampleRate: config.audioOutputSampleRate ?? DEFAULTS.audioOutputSampleRate,\n    audioChannels: config.audioChannels ?? DEFAULTS.audioChannels,\n    audioBitDepth: config.audioBitDepth ?? DEFAULTS.audioBitDepth,\n    audioBufferSize: config.audioBufferSize ?? DEFAULTS.audioBufferSize,\n    enableDebugLogging: config.enableDebugLogging ?? DEFAULTS.enableDebugLogging,\n    aiClinicMode: config.aiClinicMode ?? DEFAULTS.aiClinicMode,\n    fillerPhraseEn: config.fillerPhraseEn,\n    fillerPhraseAr: config.fillerPhraseAr,\n  };\n}\n","import { TypedEventEmitter } from './event-emitter';\nimport { WebSocketManager } from './websocket-manager';\nimport { AudioCaptureManager } from './audio-capture-manager';\nimport { AudioPlaybackManager } from './audio-playback-manager';\nimport { EchoPrevention } from './echo-prevention';\nimport { resolveConfig } from './voice-stream-config';\nimport { setDebugLogging, logDebug, logError } from './utils/logger';\nimport type {\n  VoiceStreamConfig,\n  ResolvedConfig,\n  ConnectionState,\n  VoiceStreamEventMap,\n  VoiceStreamError,\n  TranscriptData,\n  AssistantMessageData,\n  LlmRequiredData,\n  DiagnosticData,\n} from './types';\n\n/**\n * Main VoiceStreamSDK class  orchestrates WebSocket, audio capture,\n * audio playback, and echo prevention.\n *\n * Mirrors iOS VoiceStreamSDK.swift\n *\n * Usage:\n *   const sdk = new VoiceStreamSDK({ serverUrl: '...', tenantId: '...' });\n *   sdk.on('connected', () => sdk.startAudioStreaming());\n *   sdk.on('transcript', (data) => console.log(data.text));\n *   await sdk.connect();\n */\nexport class VoiceStreamSDK extends TypedEventEmitter<VoiceStreamEventMap> {\n  private config: ResolvedConfig;\n  private wsManager: WebSocketManager;\n  private captureManager: AudioCaptureManager;\n  private playbackManager: AudioPlaybackManager;\n  private echoPrevention: EchoPrevention;\n  private _streaming = false;\n  private unsubscribers: (() => void)[] = [];\n\n  constructor(config: VoiceStreamConfig) {\n    super();\n    this.config = resolveConfig(config);\n    setDebugLogging(this.config.enableDebugLogging);\n\n    // Create managers\n    this.wsManager = new WebSocketManager(this.config);\n    this.captureManager = new AudioCaptureManager(this.config);\n    this.playbackManager = new AudioPlaybackManager(this.config);\n    this.echoPrevention = new EchoPrevention(this.captureManager, this.playbackManager);\n\n    // Wire up WebSocket events\n    this.wireWebSocketEvents();\n    // Wire up audio capture events\n    this.wireAudioCaptureEvents();\n  }\n\n  //  Connection \n\n  /**\n   * Connect to the voice streaming server.\n   */\n  connect(): void {\n    logDebug('Connecting...');\n    this.wsManager.connect();\n  }\n\n  /**\n   * Disconnect from the server.\n   */\n  disconnect(): void {\n    logDebug('Disconnecting...');\n    this.stopAudioStreaming();\n    this.wsManager.disconnect();\n  }\n\n  /**\n   * Whether the SDK is connected to the server.\n   */\n  isConnected(): boolean {\n    return this.wsManager.isConnected();\n  }\n\n  /**\n   * Current connection state.\n   */\n  getConnectionState(): ConnectionState {\n    return this.wsManager.getConnectionState();\n  }\n\n  //  Audio Streaming \n\n  /**\n   * Start bidirectional audio streaming (mic capture + speaker playback).\n   */\n  async startAudioStreaming(): Promise<void> {\n    if (this._streaming) return;\n    if (!this.isConnected()) {\n      logError('Cannot start streaming: not connected');\n      return;\n    }\n\n    await this.captureManager.startCapture();\n    this._streaming = true;\n    logDebug('Audio streaming started');\n  }\n\n  /**\n   * Stop audio streaming.\n   */\n  stopAudioStreaming(): void {\n    if (!this._streaming) return;\n\n    this.captureManager.stopCapture();\n    this.playbackManager.clearQueue();\n    this.echoPrevention.forceUnmute();\n    this._streaming = false;\n    logDebug('Audio streaming stopped');\n  }\n\n  /**\n   * Whether audio streaming is active.\n   */\n  isStreaming(): boolean {\n    return this._streaming;\n  }\n\n  /**\n   * Ensure playback-only mode (no capture). Used for greeting audio.\n   */\n  ensurePlayback(): void {\n    // Playback auto-starts when audio is enqueued, nothing to do\n    logDebug('Playback-only mode ensured');\n  }\n\n  //  Messaging \n\n  /**\n   * Send a raw text message over WebSocket.\n   */\n  sendMessage(text: string): void {\n    this.wsManager.sendText(text);\n  }\n\n  /**\n   * Send a chat message (AI Clinic mode).\n   */\n  sendChatMessage(text: string): void {\n    this.wsManager.sendJSON({\n      type: 'chat_message',\n      text,\n    });\n  }\n\n  /**\n   * Send an LLM response to be spoken via TTS (AI Clinic mode).\n   */\n  sendLlmResponse(text: string): void {\n    this.wsManager.sendJSON({\n      type: 'llm_response',\n      text,\n    });\n  }\n\n  //  Audio Queue \n\n  /**\n   * Clear queued audio and force-unmute the mic.\n   */\n  clearAudioQueue(): void {\n    this.playbackManager.clearQueue();\n    this.echoPrevention.forceUnmute();\n  }\n\n  //  Lifecycle \n\n  /**\n   * Clean up all resources. Call when done with the SDK.\n   */\n  cleanup(): void {\n    this.stopAudioStreaming();\n    this.echoPrevention.destroy();\n    this.captureManager.cleanup();\n    this.playbackManager.cleanup();\n    this.wsManager.cleanup();\n\n    for (const unsub of this.unsubscribers) {\n      unsub();\n    }\n    this.unsubscribers = [];\n    this.removeAllListeners();\n    logDebug('SDK cleaned up');\n  }\n\n  //  Internal Wiring \n\n  private wireWebSocketEvents(): void {\n    // Connection state changes\n    this.unsubscribers.push(\n      this.wsManager.on('connectionStateChanged', (state) => {\n        this.emit('connectionStateChanged', state);\n      }),\n    );\n\n    // Connected\n    this.unsubscribers.push(\n      this.wsManager.on('open', () => {\n        this.emit('connected');\n      }),\n    );\n\n    // Disconnected\n    this.unsubscribers.push(\n      this.wsManager.on('close', (data) => {\n        if (this._streaming) {\n          this.stopAudioStreaming();\n        }\n        this.emit('disconnected', { reason: data.reason });\n      }),\n    );\n\n    // Connection error\n    this.unsubscribers.push(\n      this.wsManager.on('error', (msg) => {\n        const error: VoiceStreamError = {\n          code: 'CONNECTION_FAILED',\n          message: msg,\n        };\n        this.emit('error', error);\n      }),\n    );\n\n    // Binary audio from server  playback\n    this.unsubscribers.push(\n      this.wsManager.on('binaryMessage', (data) => {\n        this.playbackManager.enqueueAudio(data);\n        this.emit('audioReceived', data);\n      }),\n    );\n\n    // Text messages from server  parse and route\n    this.unsubscribers.push(\n      this.wsManager.on('textMessage', (text) => {\n        this.routeTextMessage(text);\n      }),\n    );\n  }\n\n  private wireAudioCaptureEvents(): void {\n    // Captured audio  send to server\n    this.unsubscribers.push(\n      this.captureManager.on('data', (audioData) => {\n        this.wsManager.sendBinary(audioData);\n        this.emit('audioSent', audioData);\n      }),\n    );\n\n    // Capture errors\n    this.unsubscribers.push(\n      this.captureManager.on('error', (error) => {\n        this.emit('error', error);\n      }),\n    );\n  }\n\n  private routeTextMessage(text: string): void {\n    try {\n      const msg = JSON.parse(text);\n      const type = msg.type;\n\n      switch (type) {\n        case 'transcript': {\n          const data: TranscriptData = {\n            text: msg.text ?? '',\n            isFinal: msg.is_final ?? false,\n            language: msg.language ?? 'en',\n            requiresResponse: msg.requires_response ?? false,\n          };\n          this.emit('transcript', data);\n          break;\n        }\n\n        case 'assistant_message': {\n          const data: AssistantMessageData = {\n            text: msg.text ?? '',\n          };\n          this.emit('assistantMessage', data);\n          break;\n        }\n\n        case 'llm_required': {\n          const data: LlmRequiredData = {\n            question: msg.question ?? msg.text ?? '',\n          };\n          this.emit('llmRequired', data);\n          break;\n        }\n\n        case 'filler_started':\n          this.emit('fillerStarted');\n          break;\n\n        case 'ready':\n          this.emit('ready');\n          break;\n\n        case 'interrupt':\n          this.clearAudioQueue();\n          this.emit('interrupt');\n          break;\n\n        case 'diagnostic': {\n          const data: DiagnosticData = {\n            code: msg.code ?? '',\n            message: msg.message ?? '',\n          };\n          this.emit('diagnostic', data);\n          break;\n        }\n\n        case 'pong':\n          // Keep-alive response, ignore\n          break;\n\n        default:\n          // Forward raw message for custom handling\n          this.emit('message', text);\n          break;\n      }\n    } catch {\n      // Non-JSON text message\n      this.emit('message', text);\n    }\n  }\n}\n","import { useState, useRef, useEffect, useCallback } from 'react';\nimport { VoiceStreamSDK } from '../../core/voice-stream-sdk';\nimport type {\n  VoiceStreamConfig,\n  ConnectionState,\n  VoiceStreamError,\n  LlmRequiredData,\n} from '../../core/types';\nimport type { ChatMessage } from '../types';\n\nlet idCounter = 0;\nfunction uniqueId(): string {\n  return `msg_${Date.now()}_${++idCounter}`;\n}\n\ninterface UseVoiceChatOptions {\n  onConnectionStateChanged?: (state: ConnectionState) => void;\n  onError?: (error: VoiceStreamError) => void;\n  onLlmResponseRequired?: (data: LlmRequiredData) => Promise<string>;\n}\n\nexport interface UseVoiceChatReturn {\n  messages: ChatMessage[];\n  isExpanded: boolean;\n  isStreaming: boolean;\n  isConnected: boolean;\n  connectionState: ConnectionState;\n  subtitle: string;\n  toggleExpanded: () => void;\n  connect: () => void;\n  disconnect: () => void;\n  toggleMic: () => Promise<void>;\n  sendTextMessage: (text: string) => void;\n}\n\n/**\n * Core state management hook for the voice chat widget.\n * Mirrors iOS VoiceChatViewModel.swift\n */\nexport function useVoiceChat(\n  config: VoiceStreamConfig,\n  options?: UseVoiceChatOptions,\n): UseVoiceChatReturn {\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [isStreaming, setIsStreaming] = useState(false);\n  const [isConnected, setIsConnected] = useState(false);\n  const [connectionState, setConnectionState] = useState<ConnectionState>('disconnected');\n  const [subtitle, setSubtitle] = useState('Tap to start');\n\n  const sdkRef = useRef<VoiceStreamSDK | null>(null);\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  // Initialize SDK once\n  useEffect(() => {\n    const sdk = new VoiceStreamSDK(config);\n    sdkRef.current = sdk;\n\n    // Connection state\n    sdk.on('connectionStateChanged', (state) => {\n      setConnectionState(state);\n      setIsConnected(state === 'connected');\n      optionsRef.current?.onConnectionStateChanged?.(state);\n\n      switch (state) {\n        case 'connecting':\n          setSubtitle('Connecting...');\n          break;\n        case 'connected':\n          setSubtitle('Connected');\n          break;\n        case 'reconnecting':\n          setSubtitle('Reconnecting...');\n          break;\n        case 'disconnected':\n          setSubtitle('Tap to start');\n          setIsStreaming(false);\n          break;\n      }\n    });\n\n    // Error\n    sdk.on('error', (error) => {\n      optionsRef.current?.onError?.(error);\n      addMessage({\n        type: 'system',\n        text: error.message,\n        language: 'en',\n      });\n    });\n\n    // Transcript (user speech)\n    sdk.on('transcript', (data) => {\n      if (data.isFinal) {\n        // Remove interim messages\n        setMessages((prev) =>\n          prev.filter((m) => !(m.type === 'user' && m.isInterim)),\n        );\n        addMessage({\n          type: 'user',\n          text: data.text,\n          language: data.language,\n          isInterim: false,\n        });\n\n        // If response needed, show thinking and call LLM delegate\n        if (data.requiresResponse) {\n          addThinkingMessage();\n          handleLlmRequest({ question: data.text });\n        }\n      } else {\n        // Update or add interim message\n        setMessages((prev) => {\n          const interimIdx = prev.findIndex(\n            (m) => m.type === 'user' && m.isInterim,\n          );\n          if (interimIdx >= 0) {\n            const updated = [...prev];\n            updated[interimIdx] = { ...updated[interimIdx], text: data.text };\n            return updated;\n          }\n          return [\n            ...prev,\n            {\n              id: uniqueId(),\n              type: 'user',\n              text: data.text,\n              language: data.language,\n              timestamp: Date.now(),\n              isInterim: true,\n            },\n          ];\n        });\n      }\n    });\n\n    // Assistant message\n    sdk.on('assistantMessage', (data) => {\n      removeThinkingMessages();\n      addMessage({\n        type: 'assistant',\n        text: data.text,\n        language: 'en',\n      });\n    });\n\n    // LLM required\n    sdk.on('llmRequired', (data) => {\n      addThinkingMessage();\n      handleLlmRequest(data);\n    });\n\n    // Filler started (show thinking)\n    sdk.on('fillerStarted', () => {\n      addThinkingMessage();\n    });\n\n    // Ready\n    sdk.on('ready', () => {\n      setSubtitle('Ready');\n    });\n\n    // Interrupt\n    sdk.on('interrupt', () => {\n      removeThinkingMessages();\n    });\n\n    return () => {\n      sdk.cleanup();\n      sdkRef.current = null;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [config.serverUrl, config.tenantId]);\n\n  //  Helpers \n\n  function addMessage(partial: { type: ChatMessage['type']; text: string; language?: string; isInterim?: boolean }) {\n    const msg: ChatMessage = {\n      id: uniqueId(),\n      type: partial.type,\n      text: partial.text,\n      language: partial.language ?? 'en',\n      timestamp: Date.now(),\n      isInterim: partial.isInterim ?? false,\n    };\n    setMessages((prev) => [...prev, msg]);\n  }\n\n  function addThinkingMessage() {\n    setMessages((prev) => {\n      // Don't add if one already exists\n      if (prev.some((m) => m.type === 'thinking')) return prev;\n      return [\n        ...prev,\n        {\n          id: uniqueId(),\n          type: 'thinking' as const,\n          text: '',\n          language: 'en',\n          timestamp: Date.now(),\n          isInterim: false,\n        },\n      ];\n    });\n  }\n\n  function removeThinkingMessages() {\n    setMessages((prev) => prev.filter((m) => m.type !== 'thinking'));\n  }\n\n  async function handleLlmRequest(data: LlmRequiredData) {\n    const handler = optionsRef.current?.onLlmResponseRequired;\n    if (!handler) return;\n\n    try {\n      const response = await handler(data);\n      sdkRef.current?.sendLlmResponse(response);\n    } catch (err) {\n      removeThinkingMessages();\n      addMessage({\n        type: 'system',\n        text: 'Failed to get AI response',\n        language: 'en',\n      });\n    }\n  }\n\n  //  Actions \n\n  const toggleExpanded = useCallback(() => {\n    setIsExpanded((prev) => {\n      const next = !prev;\n      // Auto-connect on first expand\n      if (next && connectionState === 'disconnected') {\n        sdkRef.current?.connect();\n      }\n      return next;\n    });\n  }, [connectionState]);\n\n  const connect = useCallback(() => {\n    sdkRef.current?.connect();\n  }, []);\n\n  const disconnect = useCallback(() => {\n    sdkRef.current?.disconnect();\n  }, []);\n\n  const toggleMic = useCallback(async () => {\n    const sdk = sdkRef.current;\n    if (!sdk) return;\n\n    if (sdk.isStreaming()) {\n      sdk.stopAudioStreaming();\n      setIsStreaming(false);\n      setSubtitle('Mic off');\n    } else {\n      await sdk.startAudioStreaming();\n      setIsStreaming(true);\n      setSubtitle('Listening...');\n    }\n  }, []);\n\n  const sendTextMessage = useCallback((text: string) => {\n    const trimmed = text.trim();\n    if (!trimmed) return;\n\n    addMessage({\n      type: 'user',\n      text: trimmed,\n      language: 'en',\n    });\n\n    sdkRef.current?.sendChatMessage(trimmed);\n    addThinkingMessage();\n  }, []);\n\n  return {\n    messages,\n    isExpanded,\n    isStreaming,\n    isConnected,\n    connectionState,\n    subtitle,\n    toggleExpanded,\n    connect,\n    disconnect,\n    toggleMic,\n    sendTextMessage,\n  };\n}\n","export interface VoiceChatTheme {\n  /** Primary brand color */\n  primaryColor: string;\n  /** Lighter shade of primary */\n  primaryColorLight: string;\n  /** Panel background color */\n  backgroundColor: string;\n  /** Primary text color */\n  textColor: string;\n  /** User bubble background */\n  userBubbleColor: string;\n  /** User bubble text color */\n  userBubbleTextColor: string;\n  /** Assistant bubble background */\n  assistantBubbleColor: string;\n  /** Assistant bubble text color */\n  assistantBubbleTextColor: string;\n  /** System message text color */\n  systemMessageColor: string;\n  /** Header gradient start */\n  headerGradientStart: string;\n  /** Header gradient end */\n  headerGradientEnd: string;\n  /** Active mic button color */\n  micActiveColor: string;\n  /** Connected status dot color */\n  connectedDotColor: string;\n  /** Disconnected status dot color */\n  disconnectedDotColor: string;\n  /** FAB diameter */\n  fabSize: number;\n  /** Chat panel max width */\n  panelMaxWidth: number;\n  /** Chat panel max height */\n  panelMaxHeight: number;\n  /** Panel border radius */\n  borderRadius: number;\n  /** Font family (System default) */\n  fontFamily: string;\n}\n\nexport const DEFAULT_THEME: VoiceChatTheme = {\n  primaryColor: '#415FAC',\n  primaryColorLight: '#6B8DE0',\n  backgroundColor: '#FFFFFF',\n  textColor: '#1F2937',\n  userBubbleColor: '#415FAC',\n  userBubbleTextColor: '#FFFFFF',\n  assistantBubbleColor: '#F0F2F5',\n  assistantBubbleTextColor: '#1F2937',\n  systemMessageColor: '#94A3B8',\n  headerGradientStart: '#3A54A0',\n  headerGradientEnd: '#6B8DE0',\n  micActiveColor: '#EF4444',\n  connectedDotColor: '#22C55E',\n  disconnectedDotColor: '#EF4444',\n  fabSize: 56,\n  panelMaxWidth: 360,\n  panelMaxHeight: 520,\n  borderRadius: 16,\n  fontFamily: 'System',\n};\n\n/**\n * Merge user's partial theme with defaults.\n */\nexport function resolveTheme(partial?: Partial<VoiceChatTheme>): VoiceChatTheme {\n  if (!partial) return DEFAULT_THEME;\n  return { ...DEFAULT_THEME, ...partial };\n}\n","import React from 'react';\nimport { TouchableOpacity, View, StyleSheet } from 'react-native';\nimport type { FloatingButtonProps } from '../types';\n\n/**\n * Floating Action Button that opens/closes the chat panel.\n * Mirrors iOS VoiceChatView FAB.\n */\nexport function FloatingButton({ theme, isExpanded, onPress, position }: FloatingButtonProps) {\n  if (isExpanded) return null;\n\n  const positionStyle = position === 'bottom-left'\n    ? { left: 16, bottom: 32 }\n    : { right: 16, bottom: 32 };\n\n  return (\n    <TouchableOpacity\n      onPress={onPress}\n      activeOpacity={0.8}\n      style={[\n        styles.fab,\n        positionStyle,\n        {\n          width: theme.fabSize,\n          height: theme.fabSize,\n          borderRadius: theme.fabSize / 2,\n          backgroundColor: theme.primaryColor,\n        },\n      ]}\n    >\n      {/* Headphones icon */}\n      <View style={styles.iconContainer}>\n        <View style={[styles.headphoneArc, { borderColor: '#fff' }]} />\n        <View style={styles.earPieceRow}>\n          <View style={[styles.earPiece, { backgroundColor: '#fff' }]} />\n          <View style={[styles.earPiece, { backgroundColor: '#fff' }]} />\n        </View>\n      </View>\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  fab: {\n    position: 'absolute',\n    alignItems: 'center',\n    justifyContent: 'center',\n    elevation: 8,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.3,\n    shadowRadius: 8,\n    zIndex: 1000,\n  },\n  iconContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: 24,\n    height: 24,\n  },\n  headphoneArc: {\n    width: 18,\n    height: 10,\n    borderWidth: 2.5,\n    borderBottomWidth: 0,\n    borderTopLeftRadius: 10,\n    borderTopRightRadius: 10,\n    backgroundColor: 'transparent',\n  },\n  earPieceRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    width: 20,\n    marginTop: -1,\n  },\n  earPiece: {\n    width: 5,\n    height: 8,\n    borderRadius: 2,\n  },\n});\n","import React from 'react';\nimport { View, Text, StyleSheet } from 'react-native';\nimport type { ConnectionState } from '../../core/types';\nimport type { VoiceChatTheme } from '../theme';\n\ninterface StatusIndicatorProps {\n  connectionState: ConnectionState;\n  subtitle: string;\n  theme: VoiceChatTheme;\n}\n\nexport function StatusIndicator({ connectionState, subtitle, theme }: StatusIndicatorProps) {\n  const isConnected = connectionState === 'connected';\n  const dotColor = isConnected ? theme.connectedDotColor : theme.disconnectedDotColor;\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.dot, { backgroundColor: dotColor }]} />\n      <Text style={styles.text}>{subtitle}</Text>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n  },\n  dot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n  text: {\n    fontSize: 12,\n    color: 'rgba(255,255,255,0.8)',\n  },\n});\n","import React from 'react';\nimport { View, Text, TouchableOpacity, StyleSheet } from 'react-native';\nimport { StatusIndicator } from './StatusIndicator';\nimport type { ChatHeaderProps } from '../types';\n\n/**\n * Chat panel header with gradient background, title, status, and close button.\n * Mirrors iOS VoiceChatView header.\n *\n * Note: Uses solid background by default. If react-native-linear-gradient\n * is available, consumers can wrap this or pass gradient colors.\n */\nexport function ChatHeader({ theme, connectionState, subtitle, onClose }: ChatHeaderProps) {\n  return (\n    <View style={[styles.container, { backgroundColor: theme.headerGradientStart }]}>\n      {/* Avatar */}\n      <View style={[styles.avatar, { backgroundColor: 'rgba(255,255,255,0.2)' }]}>\n        <View style={styles.avatarIconContainer}>\n          <View style={[styles.headphoneArc, { borderColor: '#fff' }]} />\n          <View style={styles.earPieceRow}>\n            <View style={[styles.earPiece, { backgroundColor: '#fff' }]} />\n            <View style={[styles.earPiece, { backgroundColor: '#fff' }]} />\n          </View>\n        </View>\n      </View>\n\n      {/* Title + Status */}\n      <View style={styles.info}>\n        <Text style={styles.title}>AI Assistant</Text>\n        <StatusIndicator\n          connectionState={connectionState}\n          subtitle={subtitle}\n          theme={theme}\n        />\n      </View>\n\n      {/* Close button */}\n      <TouchableOpacity onPress={onClose} style={styles.closeButton} hitSlop={{ top: 8, bottom: 8, left: 8, right: 8 }}>\n        <View style={styles.closeIcon}>\n          <View style={[styles.closeLine, styles.closeLineA]} />\n          <View style={[styles.closeLine, styles.closeLineB]} />\n        </View>\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 16,\n    paddingVertical: 14,\n    borderTopLeftRadius: 16,\n    borderTopRightRadius: 16,\n  },\n  avatar: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: 10,\n  },\n  avatarIconContainer: {\n    alignItems: 'center',\n    width: 18,\n    height: 18,\n  },\n  headphoneArc: {\n    width: 14,\n    height: 8,\n    borderWidth: 2,\n    borderBottomWidth: 0,\n    borderTopLeftRadius: 8,\n    borderTopRightRadius: 8,\n    backgroundColor: 'transparent',\n  },\n  earPieceRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    width: 16,\n    marginTop: -1,\n  },\n  earPiece: {\n    width: 4,\n    height: 6,\n    borderRadius: 1.5,\n  },\n  info: {\n    flex: 1,\n  },\n  title: {\n    color: '#fff',\n    fontSize: 15,\n    fontWeight: '600',\n    marginBottom: 2,\n  },\n  closeButton: {\n    width: 28,\n    height: 28,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderRadius: 14,\n    backgroundColor: 'rgba(255,255,255,0.15)',\n  },\n  closeIcon: {\n    width: 12,\n    height: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  closeLine: {\n    position: 'absolute',\n    width: 12,\n    height: 2,\n    backgroundColor: '#fff',\n    borderRadius: 1,\n  },\n  closeLineA: {\n    transform: [{ rotate: '45deg' }],\n  },\n  closeLineB: {\n    transform: [{ rotate: '-45deg' }],\n  },\n});\n","import React, { useEffect, useRef } from 'react';\nimport { View, Text, Animated, StyleSheet } from 'react-native';\nimport type { MessageBubbleProps } from '../types';\n\n/**\n * Renders a single chat message bubble.\n * Supports user, assistant, system, and thinking types.\n * Mirrors iOS VoiceChatView bubble styles.\n */\nexport function MessageBubble({ message, theme }: MessageBubbleProps) {\n  if (message.type === 'thinking') {\n    return <ThinkingIndicator theme={theme} />;\n  }\n\n  if (message.type === 'system') {\n    return (\n      <View style={styles.systemContainer}>\n        <Text style={[styles.systemText, { color: theme.systemMessageColor }]}>\n          {message.text}\n        </Text>\n      </View>\n    );\n  }\n\n  const isUser = message.type === 'user';\n  const isRTL = message.language === 'ar';\n\n  return (\n    <View\n      style={[\n        styles.bubbleRow,\n        isUser ? styles.userRow : styles.assistantRow,\n      ]}\n    >\n      {/* AI avatar badge for assistant */}\n      {!isUser && (\n        <View style={[styles.avatar, { backgroundColor: theme.primaryColor }]}>\n          <Text style={styles.avatarText}>AI</Text>\n        </View>\n      )}\n\n      <View\n        style={[\n          styles.bubble,\n          isUser\n            ? [\n                styles.userBubble,\n                { backgroundColor: theme.userBubbleColor },\n              ]\n            : [\n                styles.assistantBubble,\n                { backgroundColor: theme.assistantBubbleColor },\n              ],\n        ]}\n      >\n        <Text\n          style={[\n            styles.bubbleText,\n            {\n              color: isUser\n                ? theme.userBubbleTextColor\n                : theme.assistantBubbleTextColor,\n              textAlign: isRTL ? 'right' : 'left',\n              writingDirection: isRTL ? 'rtl' : 'ltr',\n            },\n          ]}\n        >\n          {message.text}\n        </Text>\n      </View>\n    </View>\n  );\n}\n\n/**\n * Animated three-dot thinking indicator.\n */\nfunction ThinkingIndicator({ theme }: { theme: MessageBubbleProps['theme'] }) {\n  const dot1 = useRef(new Animated.Value(0.3)).current;\n  const dot2 = useRef(new Animated.Value(0.3)).current;\n  const dot3 = useRef(new Animated.Value(0.3)).current;\n\n  useEffect(() => {\n    const animate = (dot: Animated.Value, delay: number) =>\n      Animated.loop(\n        Animated.sequence([\n          Animated.delay(delay),\n          Animated.timing(dot, {\n            toValue: 1,\n            duration: 300,\n            useNativeDriver: true,\n          }),\n          Animated.timing(dot, {\n            toValue: 0.3,\n            duration: 300,\n            useNativeDriver: true,\n          }),\n        ]),\n      );\n\n    animate(dot1, 0).start();\n    animate(dot2, 150).start();\n    animate(dot3, 300).start();\n\n    return () => {\n      dot1.stopAnimation();\n      dot2.stopAnimation();\n      dot3.stopAnimation();\n    };\n  }, [dot1, dot2, dot3]);\n\n  return (\n    <View style={styles.assistantRow}>\n      <View style={[styles.avatar, { backgroundColor: theme.primaryColor }]}>\n        <Text style={styles.avatarText}>AI</Text>\n      </View>\n      <View style={[styles.bubble, styles.assistantBubble, { backgroundColor: theme.assistantBubbleColor }]}>\n        <View style={styles.dotsRow}>\n          {[dot1, dot2, dot3].map((dot, i) => (\n            <Animated.View\n              key={i}\n              style={[\n                styles.thinkingDot,\n                { backgroundColor: theme.systemMessageColor, opacity: dot },\n              ]}\n            />\n          ))}\n        </View>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  bubbleRow: {\n    flexDirection: 'row',\n    marginBottom: 8,\n    paddingHorizontal: 12,\n    alignItems: 'flex-end',\n  },\n  userRow: {\n    justifyContent: 'flex-end',\n  },\n  assistantRow: {\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    marginBottom: 8,\n    paddingHorizontal: 12,\n    alignItems: 'flex-end',\n  },\n  avatar: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: 6,\n  },\n  avatarText: {\n    color: '#fff',\n    fontSize: 9,\n    fontWeight: '700',\n  },\n  bubble: {\n    maxWidth: '75%',\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    borderRadius: 16,\n  },\n  userBubble: {\n    borderBottomRightRadius: 4,\n  },\n  assistantBubble: {\n    borderBottomLeftRadius: 4,\n  },\n  bubbleText: {\n    fontSize: 14,\n    lineHeight: 20,\n  },\n  systemContainer: {\n    alignItems: 'center',\n    marginVertical: 4,\n    paddingHorizontal: 16,\n  },\n  systemText: {\n    fontSize: 12,\n    textAlign: 'center',\n    backgroundColor: 'rgba(0,0,0,0.04)',\n    paddingHorizontal: 12,\n    paddingVertical: 4,\n    borderRadius: 10,\n    overflow: 'hidden',\n  },\n  dotsRow: {\n    flexDirection: 'row',\n    gap: 4,\n    paddingVertical: 4,\n    paddingHorizontal: 4,\n  },\n  thinkingDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n});\n","import React, { useRef, useEffect } from 'react';\nimport { FlatList, StyleSheet } from 'react-native';\nimport { MessageBubble } from './MessageBubble';\nimport type { ChatMessage } from '../types';\nimport type { VoiceChatTheme } from '../theme';\n\ninterface MessageListProps {\n  messages: ChatMessage[];\n  theme: VoiceChatTheme;\n}\n\n/**\n * Scrollable message list with auto-scroll to bottom.\n * Mirrors iOS VoiceChatView message list.\n */\nexport function MessageList({ messages, theme }: MessageListProps) {\n  const listRef = useRef<FlatList>(null);\n\n  // Auto-scroll to bottom when new messages arrive\n  useEffect(() => {\n    if (messages.length > 0) {\n      setTimeout(() => {\n        listRef.current?.scrollToEnd({ animated: true });\n      }, 100);\n    }\n  }, [messages.length]);\n\n  return (\n    <FlatList\n      ref={listRef}\n      data={messages}\n      keyExtractor={(item) => item.id}\n      renderItem={({ item }) => <MessageBubble message={item} theme={theme} />}\n      style={styles.list}\n      contentContainerStyle={styles.content}\n      showsVerticalScrollIndicator={false}\n      keyboardShouldPersistTaps=\"handled\"\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  list: {\n    flex: 1,\n  },\n  content: {\n    paddingVertical: 12,\n  },\n});\n","import React, { useEffect, useRef } from 'react';\nimport { View, TouchableOpacity, Animated, StyleSheet } from 'react-native';\nimport type { MicButtonProps } from '../types';\n\n/**\n * Microphone button with red pulse animation when streaming.\n * Mirrors iOS mic button with ripple animation.\n */\nexport function MicButton({ theme, isStreaming, isConnected, onPress }: MicButtonProps) {\n  const pulseAnim = useRef(new Animated.Value(1)).current;\n  const opacityAnim = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    if (isStreaming) {\n      Animated.loop(\n        Animated.sequence([\n          Animated.parallel([\n            Animated.timing(pulseAnim, {\n              toValue: 1.4,\n              duration: 750,\n              useNativeDriver: true,\n            }),\n            Animated.timing(opacityAnim, {\n              toValue: 0,\n              duration: 750,\n              useNativeDriver: true,\n            }),\n          ]),\n          Animated.parallel([\n            Animated.timing(pulseAnim, {\n              toValue: 1,\n              duration: 0,\n              useNativeDriver: true,\n            }),\n            Animated.timing(opacityAnim, {\n              toValue: 0.3,\n              duration: 0,\n              useNativeDriver: true,\n            }),\n          ]),\n        ]),\n      ).start();\n    } else {\n      pulseAnim.setValue(1);\n      opacityAnim.setValue(0);\n    }\n  }, [isStreaming, pulseAnim, opacityAnim]);\n\n  const bgColor = isStreaming ? theme.micActiveColor : theme.primaryColor;\n\n  return (\n    <View style={styles.wrapper}>\n      {/* Pulse ring */}\n      {isStreaming && (\n        <Animated.View\n          style={[\n            styles.pulseRing,\n            {\n              backgroundColor: theme.micActiveColor,\n              opacity: opacityAnim,\n              transform: [{ scale: pulseAnim }],\n            },\n          ]}\n        />\n      )}\n\n      <TouchableOpacity\n        onPress={onPress}\n        disabled={!isConnected}\n        activeOpacity={0.7}\n        style={[\n          styles.button,\n          { backgroundColor: bgColor },\n          !isConnected && styles.disabled,\n        ]}\n      >\n        {/* Mic SVG icon */}\n        <View style={styles.iconContainer}>\n          <View style={[styles.micBody, { backgroundColor: '#fff' }]} />\n          <View style={[styles.micBase, { borderColor: '#fff' }]} />\n        </View>\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  wrapper: {\n    width: 44,\n    height: 44,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  pulseRing: {\n    position: 'absolute',\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n  },\n  button: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n    elevation: 2,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.2,\n    shadowRadius: 2,\n  },\n  disabled: {\n    opacity: 0.5,\n  },\n  iconContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: 16,\n    height: 20,\n  },\n  micBody: {\n    width: 8,\n    height: 12,\n    borderRadius: 4,\n  },\n  micBase: {\n    width: 14,\n    height: 7,\n    borderWidth: 2,\n    borderTopWidth: 0,\n    borderBottomLeftRadius: 7,\n    borderBottomRightRadius: 7,\n    marginTop: -2,\n    backgroundColor: 'transparent',\n  },\n});\n","import React, { useState } from 'react';\nimport { View, TextInput, TouchableOpacity, StyleSheet } from 'react-native';\nimport { MicButton } from './MicButton';\nimport type { InputBarProps } from '../types';\n\n/**\n * Input bar with text field, send button, and mic toggle.\n * Mirrors iOS VoiceChatView input bar.\n */\nexport function InputBar({ theme, isStreaming, isConnected, onSendText, onMicToggle }: InputBarProps) {\n  const [text, setText] = useState('');\n\n  const handleSend = () => {\n    if (!text.trim()) return;\n    onSendText(text.trim());\n    setText('');\n  };\n\n  return (\n    <View style={styles.container}>\n      <TextInput\n        style={[styles.input, { color: theme.textColor }]}\n        value={text}\n        onChangeText={setText}\n        placeholder=\"Type a message...\"\n        placeholderTextColor=\"#9CA3AF\"\n        returnKeyType=\"send\"\n        onSubmitEditing={handleSend}\n        editable={isConnected}\n      />\n\n      {/* Send button (visible when text entered) */}\n      {text.trim().length > 0 ? (\n        <TouchableOpacity\n          onPress={handleSend}\n          style={[styles.sendButton, { backgroundColor: theme.primaryColor }]}\n          activeOpacity={0.7}\n        >\n          {/* Arrow up icon */}\n          <View style={styles.arrowUp}>\n            <View style={[styles.arrowLine, { backgroundColor: '#fff' }]} />\n            <View style={[styles.arrowHead, { borderBottomColor: '#fff' }]} />\n          </View>\n        </TouchableOpacity>\n      ) : (\n        <MicButton\n          theme={theme}\n          isStreaming={isStreaming}\n          isConnected={isConnected}\n          onPress={onMicToggle}\n        />\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    backgroundColor: '#F3F4F6',\n    gap: 8,\n  },\n  input: {\n    flex: 1,\n    height: 36,\n    fontSize: 14,\n    paddingHorizontal: 12,\n    backgroundColor: '#fff',\n    borderRadius: 18,\n    borderWidth: 1,\n    borderColor: '#E5E7EB',\n  },\n  sendButton: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  arrowUp: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: 14,\n    height: 14,\n  },\n  arrowLine: {\n    width: 2,\n    height: 10,\n    borderRadius: 1,\n  },\n  arrowHead: {\n    width: 0,\n    height: 0,\n    borderLeftWidth: 5,\n    borderRightWidth: 5,\n    borderBottomWidth: 6,\n    borderLeftColor: 'transparent',\n    borderRightColor: 'transparent',\n    marginTop: -6,\n  },\n});\n","import React from 'react';\nimport { View, Text, StyleSheet } from 'react-native';\n\nexport function PoweredByFooter() {\n  return (\n    <View style={styles.container}>\n      <Text style={styles.text}>Powered by smartserve.ai</Text>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    paddingVertical: 6,\n    alignItems: 'center',\n  },\n  text: {\n    fontSize: 10,\n    color: 'rgba(0,0,0,0.3)',\n  },\n});\n","import React from 'react';\nimport { View, StyleSheet, Dimensions, KeyboardAvoidingView, Platform } from 'react-native';\nimport { ChatHeader } from './ChatHeader';\nimport { MessageList } from './MessageList';\nimport { InputBar } from './InputBar';\nimport { PoweredByFooter } from './PoweredByFooter';\nimport type { ChatPanelProps } from '../types';\n\nconst { width: screenWidth, height: screenHeight } = Dimensions.get('window');\n\n/**\n * Expanded chat panel with header, message list, and input bar.\n * Mirrors iOS VoiceChatView expanded state.\n */\nexport function ChatPanel({\n  theme,\n  messages,\n  connectionState,\n  isStreaming,\n  subtitle,\n  onClose,\n  onSendText,\n  onMicToggle,\n}: ChatPanelProps) {\n  const panelWidth = Math.min(theme.panelMaxWidth, screenWidth - 32);\n  const panelHeight = Math.min(theme.panelMaxHeight, screenHeight - 120);\n\n  return (\n    <KeyboardAvoidingView\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      style={styles.keyboardAvoid}\n    >\n      <View\n        style={[\n          styles.panel,\n          {\n            width: panelWidth,\n            height: panelHeight,\n            backgroundColor: theme.backgroundColor,\n            borderRadius: theme.borderRadius,\n          },\n        ]}\n      >\n        <ChatHeader\n          theme={theme}\n          connectionState={connectionState}\n          subtitle={subtitle}\n          onClose={onClose}\n        />\n\n        <MessageList\n          messages={messages}\n          theme={theme}\n        />\n\n        <PoweredByFooter />\n\n        <InputBar\n          theme={theme}\n          isStreaming={isStreaming}\n          isConnected={connectionState === 'connected'}\n          onSendText={onSendText}\n          onMicToggle={onMicToggle}\n        />\n      </View>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  keyboardAvoid: {\n    position: 'absolute',\n    right: 16,\n    bottom: 32,\n    zIndex: 1001,\n  },\n  panel: {\n    overflow: 'hidden',\n    elevation: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 8 },\n    shadowOpacity: 0.15,\n    shadowRadius: 16,\n  },\n});\n","import React from 'react';\nimport { View, TouchableWithoutFeedback, StyleSheet } from 'react-native';\nimport { useVoiceChat } from '../hooks/use-voice-chat';\nimport { resolveTheme } from '../theme';\nimport { FloatingButton } from './FloatingButton';\nimport { ChatPanel } from './ChatPanel';\nimport type { VoiceChatWidgetProps } from '../types';\n\n/**\n * Drop-in voice chat widget with floating action button.\n * Renders a FAB that expands into a full chat panel.\n *\n * Mirrors iOS VoiceChatView.swift\n *\n * Usage:\n *   <VoiceChatWidget\n *     config={{ serverUrl: '...', tenantId: '...' }}\n *     theme={{ primaryColor: '#6366F1' }}\n *     onLlmResponseRequired={async ({ question }) => await myLLM(question)}\n *   />\n */\nexport function VoiceChatWidget({\n  config,\n  theme: themeOverrides,\n  position = 'bottom-right',\n  onConnectionStateChanged,\n  onError,\n  onLlmResponseRequired,\n}: VoiceChatWidgetProps) {\n  const theme = resolveTheme(themeOverrides);\n\n  const voiceChat = useVoiceChat(config, {\n    onConnectionStateChanged,\n    onError,\n    onLlmResponseRequired,\n  });\n\n  return (\n    <View style={styles.container} pointerEvents=\"box-none\">\n      {/* Dim overlay when expanded */}\n      {voiceChat.isExpanded && (\n        <TouchableWithoutFeedback onPress={voiceChat.toggleExpanded}>\n          <View style={styles.overlay} />\n        </TouchableWithoutFeedback>\n      )}\n\n      {/* Chat panel */}\n      {voiceChat.isExpanded && (\n        <ChatPanel\n          theme={theme}\n          messages={voiceChat.messages}\n          connectionState={voiceChat.connectionState}\n          isStreaming={voiceChat.isStreaming}\n          subtitle={voiceChat.subtitle}\n          onClose={voiceChat.toggleExpanded}\n          onSendText={voiceChat.sendTextMessage}\n          onMicToggle={voiceChat.toggleMic}\n        />\n      )}\n\n      {/* FAB */}\n      <FloatingButton\n        theme={theme}\n        isExpanded={voiceChat.isExpanded}\n        onPress={voiceChat.toggleExpanded}\n        position={position}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    ...StyleSheet.absoluteFillObject,\n    zIndex: 999,\n  },\n  overlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0,0,0,0.3)',\n  },\n});\n"]}